# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a table tennis club management web application for USFTT (US Fontenay TT) that displays player rankings, team results, and statistics. The application consists of a static HTML frontend with JavaScript and a Python backend that fetches data from the FFTT (French Table Tennis Federation) API.

## Architecture

### Frontend Structure
- **Static HTML pages** with Bootstrap 5 styling:
  - `index.html` - Player list with filtering and progression tracking
  - `classement.html` - Individual ranking/competition results
  - `equipes.html` - Team results and match statistics
  - `tests.html` - Testing page
- **Mobile-first design** with responsive navigation and bottom mobile nav
- **DataTables integration** for sortable, searchable player tables
- **CSV data consumption** - Frontend loads CSV files generated by backend scripts

### Backend Structure (`backend/` directory)
- **Primary API client**: `fftt.py` - FFTTApiClient class for interacting with FFTT Smartping 2.0 API
- **Data processing scripts**:
  - `usftt_results.py` - Fetches player data, calculates progressions, generates CSV
  - `usftt_results_teams.py` - Fetches team data and match results
- **Data storage**: CSV files for players, licenses, competitors, and team results
- **Python dependencies** managed via Pipfile (requests, pandas, beautifulsoup4, openpyxl)

### Data Flow
1. Backend Python scripts authenticate with FFTT API using environment variables
2. Scripts fetch player/team data and process it (calculate progressions, normalize divisions)
3. Data is saved to CSV files in the backend directory
4. Frontend HTML pages load these CSV files via JavaScript fetch() calls
5. DataTables renders the data with sorting, filtering, and search capabilities

## Common Development Commands

### Python Backend
```bash
cd backend/
pipenv install          # Install dependencies
pipenv shell            # Activate virtual environment
python fftt.py <endpoint> <params>  # Direct API testing
python usftt_results.py             # Generate player data CSV
python usftt_results_teams.py       # Generate team data CSV
```

### Environment Setup
Required environment variables for FFTT API access:
- `FFTT_APP_ID` - Application ID provided by FFTT
- `FFTT_PASSWORD` - Password for API authentication
- `FFTT_SERIE` - Optional series identifier

### Frontend Development
- Static files served directly (no build process required)
- Open HTML files in browser for testing
- CSV data files must be generated by backend scripts first

### Git Workflow
**Commit Message Convention**: Use semantic commit messages with emoji prefixes

Format: `<emoji> <type>: <description>`

Common types and their emojis:
- ‚ú® `feat:` - New features
- üêõ `fix:` - Bug fixes
- üìù `docs:` - Documentation changes
- üíÑ `style:` - UI/styling changes (CSS, Bootstrap)
- ‚ôªÔ∏è `refactor:` - Code refactoring
- ‚úÖ `test:` - Adding or updating tests
- üîß `chore:` - Maintenance tasks (dependencies, config, etc.)
- üöÄ `perf:` - Performance improvements
- üî• `remove:` - Removing code or files

Examples:
- `‚ú® feat: add team statistics dashboard`
- `üêõ fix: correct progression calculation for November`
- `üìù docs: update API integration instructions`
- `üîß chore: add .vscode to gitignore`

## Key Technical Details

### FFTT API Integration
- Uses HMAC-SHA1 authentication with timestamp-based tokens
- Handles XML responses and converts to Python dictionaries
- Main endpoints: player details, team data, match results, club information
- Club number: "08940073" (hardcoded for USFTT)

### Data Processing Features
- **Progression calculations**: Monthly and phase-based point changes
- **Match counting**: Filters out current month matches for accurate statistics
- **CSV merging**: Updates existing data files while preserving historical data
- **Division normalization**: Standardizes division names (N1, R1, D1, etc.)

### Frontend Features
- **Category filtering** on player lists
- **Mobile responsive** navigation with bottom tab bar
- **Sortable tables** with French localization
- **Progression highlighting** (green/red for positive/negative changes)
- **Real-time data loading** from CSV files